<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Multivariate Linear Regression &#8212; Bhishan&#39;s 1 documentation</title>
    
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Polynomial Regression" href="qn4.html" />
    <link rel="prev" title="Univariate Linear Regression" href="qn2.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="qn4.html" title="Polynomial Regression"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="qn2.html" title="Univariate Linear Regression"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bhishan&#39;s 1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="multivariate-linear-regression">
<h1>Multivariate Linear Regression<a class="headerlink" href="#multivariate-linear-regression" title="Permalink to this headline">Â¶</a></h1>
<p>In this question we fit batch gradient descent (BGD)  method to find the
house prices of given multivariate data.</p>
<p>a) The plot of J(w) versus the number of epochs with step size 10 is shown
below:</p>
<img alt="_images/multi_cost_history.png" src="_images/multi_cost_history.png" />
<p>b) After training I printed the parameters (w) for train data and compared
with normal equations. For bgd I used 500 iterations and learning rate of 0.1.
I found that weight vectors are exact same.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="n">Train</span> <span class="n">Data</span>
<span class="n">epochs</span>  <span class="n">lr</span>     <span class="n">mean</span>       <span class="n">std</span>       <span class="n">w0</span>          <span class="n">w1</span>          <span class="n">rmse</span>        <span class="n">cost</span>
<span class="mi">500</span>     <span class="mf">0.1</span>    <span class="mf">2340.46</span>     <span class="mf">808.44</span>    <span class="mi">254</span><span class="p">,</span><span class="mf">450.00</span>  <span class="mi">93</span><span class="p">,</span><span class="mf">308.92</span>   <span class="mi">64</span><span class="p">,</span><span class="mf">083.51</span>   <span class="mi">2</span><span class="p">,</span><span class="mi">053</span><span class="p">,</span><span class="mi">348</span><span class="p">,</span><span class="mf">364.32</span>

<span class="n">w_norm_eqn</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">254</span><span class="p">,</span><span class="mf">450.0000</span>  <span class="mi">78</span><span class="p">,</span><span class="mf">097.1126</span>  <span class="mi">24</span><span class="p">,</span><span class="mf">424.5992</span>  <span class="mi">2</span><span class="p">,</span><span class="mf">079.7085</span> <span class="p">]]</span>
<span class="n">w_bgd</span>      <span class="o">=</span> <span class="p">[[</span><span class="mi">254</span><span class="p">,</span><span class="mf">449.9998</span>  <span class="mi">78</span><span class="p">,</span><span class="mf">079.1811</span>  <span class="mi">24</span><span class="p">,</span><span class="mf">442.5758</span>  <span class="mi">2</span><span class="p">,</span><span class="mf">075.9564</span> <span class="p">]]</span>
</pre></div>
</div>
<ol class="loweralpha simple" start="3">
<li>Comparison of BGD and SGD.</li>
</ol>
<p>In stochastic grad desc, I shuffled the data while training. To get the
reproducible results, I set the random seed to 100. The SGD training gives
noisy results. The weight vector does not stabilize smoothly, it first decreases
rapidly then fluctuates with some noise but after some iterations it will give
similar results like BGD.</p>
<p>For this example after 468 epochs I got similar weight vectors from bgd and sgd:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">w_norm_eqn</span>        <span class="o">=</span> <span class="p">[[</span><span class="mi">254</span><span class="p">,</span><span class="mf">450.0000</span>  <span class="mi">78</span><span class="p">,</span><span class="mf">097.1126</span>  <span class="mi">24</span><span class="p">,</span><span class="mf">424.5992</span>  <span class="mi">2</span><span class="p">,</span><span class="mf">079.7085</span> <span class="p">]]</span>
<span class="n">iters</span> <span class="o">=</span> <span class="mi">500</span> <span class="n">w_BGD</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">254</span><span class="p">,</span><span class="mf">450.0000</span>  <span class="mi">78</span><span class="p">,</span><span class="mf">097.1122</span>  <span class="mi">24</span><span class="p">,</span><span class="mf">424.5995</span>  <span class="mi">2</span><span class="p">,</span><span class="mf">079.7084</span> <span class="p">]]</span>
<span class="n">iters</span> <span class="o">=</span> <span class="mi">499</span> <span class="n">w_SGD</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">254</span><span class="p">,</span><span class="mf">516.1325</span>  <span class="mi">78</span><span class="p">,</span><span class="mf">063.9833</span>  <span class="mi">24</span><span class="p">,</span><span class="mf">487.8213</span>  <span class="mi">2</span><span class="p">,</span><span class="mf">003.9658</span> <span class="p">]]</span>
<span class="n">abs_diff_min</span> <span class="o">=</span> <span class="mf">238.22658943321608</span>
<span class="nb">len</span><span class="p">(</span><span class="n">abs_diff_min_lst</span><span class="p">)</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">abs_diff_min_lst</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">468</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="qn2.html"
                        title="previous chapter">Univariate Linear Regression</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="qn4.html"
                        title="next chapter">Polynomial Regression</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/qn3.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="qn4.html" title="Polynomial Regression"
             >next</a> |</li>
        <li class="right" >
          <a href="qn2.html" title="Univariate Linear Regression"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bhishan&#39;s 1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Bhishan Poudel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>